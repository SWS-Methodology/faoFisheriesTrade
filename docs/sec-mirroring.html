<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Fishery: Trade Module</title>
  <meta name="description" content="Fisheries Trade Documentation">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Fishery: Trade Module" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.svg" />
  <meta property="og:description" content="Fisheries Trade Documentation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Fishery: Trade Module" />
  
  <meta name="twitter:description" content="Fisheries Trade Documentation" />
  <meta name="twitter:image" content="img/cover.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/logo.png" type="image/x-icon">
<link rel="prev" href="outlier-detection.html">
<link rel="next" href="appendix-a.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.10/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="ess.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#migration-team"><i class="fa fa-check"></i>Migration Team</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="sec-data.html"><a href="sec-data.html"><i class="fa fa-check"></i><b>1</b> Data</a><ul>
<li class="chapter" data-level="1.1" data-path="sec-data.html"><a href="sec-data.html#unsd---comtrade"><i class="fa fa-check"></i><b>1.1</b> UNSD - COMTRADE</a></li>
<li class="chapter" data-level="1.2" data-path="sec-data.html"><a href="sec-data.html#eurostat"><i class="fa fa-check"></i><b>1.2</b> Eurostat</a></li>
<li class="chapter" data-level="1.3" data-path="sec-data.html"><a href="sec-data.html#tdm-and-other-sources"><i class="fa fa-check"></i><b>1.3</b> TDM and other sources</a></li>
<li class="chapter" data-level="1.4" data-path="sec-data.html"><a href="sec-data.html#data-builder"><i class="fa fa-check"></i><b>1.4</b> Data Builder</a><ul>
<li class="chapter" data-level="1.4.1" data-path="sec-data.html"><a href="sec-data.html#functions"><i class="fa fa-check"></i><b>1.4.1</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sec-mapping.html"><a href="sec-mapping.html"><i class="fa fa-check"></i><b>2</b> Mapping trade data</a><ul>
<li class="chapter" data-level="2.1" data-path="sec-mapping.html"><a href="sec-mapping.html#definitions"><i class="fa fa-check"></i><b>2.1</b> Definitions</a></li>
<li class="chapter" data-level="2.2" data-path="sec-mapping.html"><a href="sec-mapping.html#mapping-module"><i class="fa fa-check"></i><b>2.2</b> Mapping Module</a></li>
<li class="chapter" data-level="2.3" data-path="sec-mapping.html"><a href="sec-mapping.html#functions-1"><i class="fa fa-check"></i><b>2.3</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sec-missing.html"><a href="sec-missing.html"><i class="fa fa-check"></i><b>3</b> Missing data</a><ul>
<li class="chapter" data-level="" data-path="sec-missing.html"><a href="sec-missing.html#data-imputation-summary"><i class="fa fa-check"></i>Data imputation summary</a></li>
<li class="chapter" data-level="" data-path="sec-missing.html"><a href="sec-missing.html#imputation-flow"><i class="fa fa-check"></i>Imputation Flow</a></li>
<li class="chapter" data-level="3.1" data-path="sec-missing.html"><a href="sec-missing.html#mathematical-conversion"><i class="fa fa-check"></i><b>3.1</b> Mathematical conversion</a></li>
<li class="chapter" data-level="3.2" data-path="sec-missing.html"><a href="sec-missing.html#partially-agreggation"><i class="fa fa-check"></i><b>3.2</b> Partially Agreggation</a></li>
<li class="chapter" data-level="3.3" data-path="sec-missing.html"><a href="sec-missing.html#methods"><i class="fa fa-check"></i><b>3.3</b> Methods</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sec-missing.html"><a href="sec-missing.html#sec:helper-tables"><i class="fa fa-check"></i><b>3.3.1</b> Helper Tables</a></li>
<li class="chapter" data-level="3.3.2" data-path="sec-missing.html"><a href="sec-missing.html#sec:weight-unit"><i class="fa fa-check"></i><b>3.3.2</b> Estimate weight per unit</a></li>
<li class="chapter" data-level="3.3.3" data-path="sec-missing.html"><a href="sec-missing.html#sec:estimate-uv"><i class="fa fa-check"></i><b>3.3.3</b> Estimate Unit Value</a></li>
<li class="chapter" data-level="3.3.4" data-path="sec-missing.html"><a href="sec-missing.html#sec:impute-partially-aggregation"><i class="fa fa-check"></i><b>3.3.4</b> Imputation by partially reported weight</a></li>
<li class="chapter" data-level="3.3.5" data-path="sec-missing.html"><a href="sec-missing.html#sec:impute-helper-tables"><i class="fa fa-check"></i><b>3.3.5</b> Imputation using the helper tables</a></li>
<li class="chapter" data-level="3.3.6" data-path="sec-missing.html"><a href="sec-missing.html#interpolate-unit-value"><i class="fa fa-check"></i><b>3.3.6</b> Interpolate Unit Value</a></li>
<li class="chapter" data-level="3.3.7" data-path="sec-missing.html"><a href="sec-missing.html#unit-value-total"><i class="fa fa-check"></i><b>3.3.7</b> Unit Value Total</a></li>
<li class="chapter" data-level="3.3.8" data-path="sec-missing.html"><a href="sec-missing.html#interpolate-unit-value-total"><i class="fa fa-check"></i><b>3.3.8</b> Interpolate Unit Value Total</a></li>
<li class="chapter" data-level="3.3.9" data-path="sec-missing.html"><a href="sec-missing.html#global-year-expanded"><i class="fa fa-check"></i><b>3.3.9</b> Global Year Expanded</a></li>
<li class="chapter" data-level="3.3.10" data-path="sec-missing.html"><a href="sec-missing.html#global-year-expanded---hs6"><i class="fa fa-check"></i><b>3.3.10</b> Global Year Expanded - HS6</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sec-missing.html"><a href="sec-missing.html#sec:impute-functions"><i class="fa fa-check"></i><b>3.4</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="outlier-detection.html"><a href="outlier-detection.html"><i class="fa fa-check"></i><b>4</b> Outlier Detection</a><ul>
<li class="chapter" data-level="4.1" data-path="outlier-detection.html"><a href="outlier-detection.html#methods-for-outlier-detection"><i class="fa fa-check"></i><b>4.1</b> Methods for outlier detection</a><ul>
<li class="chapter" data-level="4.1.1" data-path="outlier-detection.html"><a href="outlier-detection.html#boxplot-rule"><i class="fa fa-check"></i><b>4.1.1</b> Boxplot rule</a></li>
<li class="chapter" data-level="4.1.2" data-path="outlier-detection.html"><a href="outlier-detection.html#time-series"><i class="fa fa-check"></i><b>4.1.2</b> Time Series</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="outlier-detection.html"><a href="outlier-detection.html#examples"><i class="fa fa-check"></i><b>4.2</b> Examples</a></li>
<li class="chapter" data-level="4.3" data-path="outlier-detection.html"><a href="outlier-detection.html#boxplot"><i class="fa fa-check"></i><b>4.3</b> Boxplot</a><ul>
<li class="chapter" data-level="4.3.1" data-path="outlier-detection.html"><a href="outlier-detection.html#example"><i class="fa fa-check"></i><b>4.3.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="outlier-detection.html"><a href="outlier-detection.html#locally-estimated-scatterplot-smoothing-loess"><i class="fa fa-check"></i><b>4.4</b> Locally Estimated Scatterplot Smoothing (LOESS)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="outlier-detection.html"><a href="outlier-detection.html#example-1"><i class="fa fa-check"></i><b>4.4.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sec-mirroring.html"><a href="sec-mirroring.html"><i class="fa fa-check"></i><b>5</b> Trade partners</a><ul>
<li class="chapter" data-level="5.1" data-path="sec-mirroring.html"><a href="sec-mirroring.html#scheda"><i class="fa fa-check"></i><b>5.1</b> Scheda</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a><ul>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#datatables"><i class="fa fa-check"></i>Datatables</a><ul>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#data-built"><i class="fa fa-check"></i>Data built</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#trade-mapping-table"><i class="fa fa-check"></i>Trade mapping table</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#table-to-map-hs-code-to-be-mapped"><i class="fa fa-check"></i>Table to map: HS code to be mapped</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#hs-masterfile"><i class="fa fa-check"></i>HS masterfile</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#cn-masterfile"><i class="fa fa-check"></i>CN Masterfile</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#data-imputed"><i class="fa fa-check"></i>Data imputed</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#data-imputed-and-validated"><i class="fa fa-check"></i>Data imputed and validated</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#outliers-detected"><i class="fa fa-check"></i>Outliers detected</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#outliers-corrected"><i class="fa fa-check"></i>Outliers corrected</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#outliers-validated"><i class="fa fa-check"></i>Outliers validated</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#data-mirrored"><i class="fa fa-check"></i>Data mirrored</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#partnership-mapping-table"><i class="fa fa-check"></i>Partnership mapping table</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#helper-data-tables"><i class="fa fa-check"></i>Helper data tables</a></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html#data-sources"><i class="fa fa-check"></i>Data sources</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fishery: Trade Module</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:mirroring" class="section level1">
<h1><span class="header-section-number">5</span> Trade partners</h1>
<p>Some countries do not report trade. A country might not report trade (no imports and no exports), or no imports, or no exports. In these cases, we estimate their trade by applying what the reporters of the non-reporting country reported. For example, if Ecuador does not report export data we will estimate Ecuador’’s exports with the imports data reported by all countries where the partner was Ecuador. For this reason, the mirroring process is implemented when data from all reporting countries was processed (mapped, missing weights imputed, and validated), i.e. at the very end of the process.</p>
<p>The module generates the list of non-reporting countries: these are the countries present as partners but missing as reporters. For these countries the mirroring routine is applied: the corresponding trade of the non-reporting countries are extracted from the partners inverting the flows. The quantities are the same while the values are corrected by a factor of 12% due to the CIF/FOB conversion.</p>
<ul>
<li><strong>Functions:</strong>
<ul>
<li><a href="https://github.com/SWS-Methodology/faoFisheriesTrade/blob/master/shinyFisheriesTrade_prod/functions/mirrorNonReporters_fi.R"><code>mirrorNonReporters_fi</code></a></li>
<li><a href="https://github.com/SWS-Methodology/faoFisheriesTrade/blob/master/shinyFisheriesTrade_prod/functions/flowsToMirror.R"><code>flowsToMirror</code></a></li>
<li><a href="https://github.com/SWS-Methodology/faoFisheriesTrade/blob/master/shinyFisheriesTrade_prod/functions/tab_server_run_mirroring.R"><code>run_mirroring</code></a></li>
</ul></li>
</ul>
<p>In Figure <a href="sec-mirroring.html#fig:mirroring-flow">5.1</a> is introduced the mirroring workflow. The tables that store the list of non-reporting and the list of donors are working in memory, i.e., there is no data saved on hard disk or in the SWS. They are considered as temporary tables. In the Mirroring Module, the user is able to check the quality of the mirroring through data visualization, aggregations by several levels and filters by commodity codes.</p>
<div class="figure" style="text-align: center"><span id="fig:mirroring-flow"></span>
<img src="img/mirroring_flow.svg" alt="Mirroring Module Flow." width="90%" />
<p class="caption">
Figure 5.1: Mirroring Module Flow.
</p>
</div>
<p>Figure <a href="sec-mirroring.html#fig:check-non-reporting">5.2</a> shows the buttons to check the non-reporting countries, the list of donor to be removed when some country reported data not reliable.</p>
<div class="figure" style="text-align: center"><span id="fig:check-non-reporting"></span>
<img src="img/check-non-reporting.png" alt="Check the non-reporting." width="90%" />
<p class="caption">
Figure 5.2: Check the non-reporting.
</p>
</div>
<p>Figure <a href="sec-mirroring.html#fig:viz-mirror-chart">5.3</a> shows the options for data aggregation and also the time series of the commodity. The weigh, value, or unit value can be choosen to visualise the time series.</p>
<div class="figure" style="text-align: center"><span id="fig:viz-mirror-chart"></span>
<img src="img/viz-mirror-01.png" alt="Screenshot of the Mirroring validation: time series." width="90%" />
<p class="caption">
Figure 5.3: Screenshot of the Mirroring validation: time series.
</p>
</div>
<p>Figure <a href="sec-mirroring.html#fig:viz-mirror-table">5.4</a> shows the editable table. In this stage, the user can adjust any data mirrored. For instance, the user can perform a manual intervention if he is not satisfied with estimates.</p>
<div class="figure" style="text-align: center"><span id="fig:viz-mirror-table"></span>
<img src="img/viz-mirror-02.png" alt="Screenshot of the Mirroring validation: editable data." width="90%" />
<p class="caption">
Figure 5.4: Screenshot of the Mirroring validation: editable data.
</p>
</div>
<div id="scheda" class="section level2">
<h2><span class="header-section-number">5.1</span> Scheda</h2>
<p>Once the country to estimate, the flow, the year, and the list of potential donors has been selected, the tool should build the data by searching in the validated trade data for data where the country to estimate appears as a partner. Then the data will need to be transformed: partner becomes est_reporter, reporter becomes donor, and flow becomes reporter_flow. This newly created data will need to be mapped. Two situations exist:</p>
<ul>
<li>The combination est_reporter, reporter_flow, donor_code, donor_tariff_line exists in the Partnership map table then the est_reporter_scheda, and the isscfc_code are reused and the end_year is updated in the trade map.</li>
<li>The combination est_reporter, reporter_flow, donor_code, donor_tariff_line does not exist in the <a href="appendix-a.html#tab:dt-partnership-map">Partnership map table</a>. A new record needs is added in the Partnership map, using the mapping information from the donor (donor_tariff_line, donor_scheda, donor_isscfc_code, donor_isscfc_id) and a new est_reporter_scheda is generated. The startyear and endyear of this new mapping in the Parternship map table is equal to the year selected at the beginning of the mirroring process.</li>
</ul>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="outlier-detection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-a.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
