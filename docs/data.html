<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 3 Data | Fishery: Trade Module</title>
  <meta name="description" content="Fisheries Trade Documentation">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 3 Data | Fishery: Trade Module" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Fisheries Trade Documentation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data | Fishery: Trade Module" />
  
  <meta name="twitter:description" content="Fisheries Trade Documentation" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="sec-workflow.html">
<link rel="next" href="outlier-detection-in-the-aggregated-level.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="ess.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="sec-intro.html"><a href="sec-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-workflow.html"><a href="sec-workflow.html"><i class="fa fa-check"></i><b>2</b> Trade data Workflow</a><ul>
<li class="chapter" data-level="2.1" data-path="sec-workflow.html"><a href="sec-workflow.html#get-started-data"><i class="fa fa-check"></i><b>2.1</b> Get started data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a></li>
<li class="chapter" data-level="4" data-path="outlier-detection-in-the-aggregated-level.html"><a href="outlier-detection-in-the-aggregated-level.html"><i class="fa fa-check"></i><b>4</b> Outlier detection in the aggregated level</a><ul>
<li class="chapter" data-level="4.1" data-path="outlier-detection-in-the-aggregated-level.html"><a href="outlier-detection-in-the-aggregated-level.html#boxplot"><i class="fa fa-check"></i><b>4.1</b> Boxplot</a><ul>
<li class="chapter" data-level="4.1.1" data-path="outlier-detection-in-the-aggregated-level.html"><a href="outlier-detection-in-the-aggregated-level.html#example"><i class="fa fa-check"></i><b>4.1.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="outlier-detection-in-the-aggregated-level.html"><a href="outlier-detection-in-the-aggregated-level.html#median-absolute-deviation-mad"><i class="fa fa-check"></i><b>4.2</b> Median Absolute Deviation (MAD)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="outlier-detection-in-the-aggregated-level.html"><a href="outlier-detection-in-the-aggregated-level.html#example-1"><i class="fa fa-check"></i><b>4.2.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="correction-of-main-outlier.html"><a href="correction-of-main-outlier.html"><i class="fa fa-check"></i><b>5</b> Correction of main outlier</a><ul>
<li class="chapter" data-level="5.1" data-path="correction-of-main-outlier.html"><a href="correction-of-main-outlier.html#locally-estimated-scatterplot-smoothing-loess"><i class="fa fa-check"></i><b>5.1</b> Locally Estimated Scatterplot Smoothing (LOESS)</a><ul>
<li class="chapter" data-level="5.1.1" data-path="correction-of-main-outlier.html"><a href="correction-of-main-outlier.html#example-2"><i class="fa fa-check"></i><b>5.1.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="correction-of-main-outlier.html"><a href="correction-of-main-outlier.html#median-weighted-average"><i class="fa fa-check"></i><b>5.2</b> Median weighted average</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fishery: Trade Module</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data</h1>
<p>The outlier detection methods are applied in the unit value (uv) variable, which is the ratio between the monetary transaction value and its weight. In this first step of this procedure, we attempt to figure out outliers in the aggregate level, and then we try to fix the transactions (disaggregated level) that were responsible for generating the outliers detected.</p>
<p>The aggregated level means to compute the unit value by reporter, flow, and FAO code, i.e., for each combination of reporter, flow, and FAO code we calculate the ratio between the summing of the monetary value and the summing of the weight. For instance, in Table 1 is shown a subset from the full data using the following parameters:</p>
<ul>
<li><code>reporter</code>: 76</li>
<li><code>year</code>: 2005</li>
<li><code>flow</code>: 1</li>
<li><code>faocode</code>: 292.9.1.90</li>
</ul>
<div id="htmlwidget-6f56affb96726fa3baea" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f56affb96726fa3baea">{"x":{"filter":"none","caption":"<caption>Table 1: Imports of the commodity (FAOCODE) 292.9.1.90 for the year 2005, and reporter 76 (Brazil).<\/caption>","data":[[76,76,76,76,76,76,76,76,76,76,76,76],[1,1,1,1,1,1,1,1,1,1,1,1],[2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005,2005],["292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90"],[152,158,250,276,352,360,372,392,410,608,840,1248],[65438,1910,25862,19187,9160,1115712,4386,58248,71675,39387,44329,438234],[73173,613,11097,2250,7565,1505700,1000,13282,19883,71300.4324035991,5949,93719],[0.894291610293414,3.11582381729201,2.33053978552762,8.52755555555555,1.21083939193655,0.740992229527794,4.386,4.38548411383828,3.60483830407886,0.552408992094862,7.45150445453017,4.6760422112912]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>reporter<\/th>\n      <th>flow<\/th>\n      <th>year<\/th>\n      <th>faocode<\/th>\n      <th>partner<\/th>\n      <th>value<\/th>\n      <th>weight<\/th>\n      <th>uv<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[0,1,2,4,5,6,7]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatCurrency(this, row, data, 5, '$', 0, 3, ',', '.', true);\nDTWidget.formatRound(this, row, data, 6, 2, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 7, 2, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p>To calculate the unit value in the aggregate level, it is needed to apply the equation below:</p>
<p><span class="math display">\[uv = \frac{\sum_{p = 1}^{P} value_p}{\sum_{p = 1}^{P} weight_p}\]</span> where <span class="math inline">\(value_p\)</span> is the monetary value from the p-th partner, as well as <span class="math inline">\(weight_p\)</span> is the transaction weight, <span class="math inline">\(P\)</span> is the total of partners in this given combination, in this small example <span class="math inline">\(P = 12\)</span>. In order to make this report comprehensible, we show the <code>uv</code> calculation step-by-step as following:</p>
<span class="math display">\[\begin{align}
uv  &amp; = \frac{65438+1910 + \cdots + 44329+438234}{73173+613 + \cdots + 5949+93719} \\ \\
&amp; = \frac{1,893,528}{1,805,531} \\ \\
&amp; = 1.05
\end{align}\]</span>
<p>If we repeat it procedure for all available year for this combination, we will find the values shown in Table 2. The highlighted row shows the <code>uv</code> computed previously, as shown in the equations sequence.</p>
<div id="htmlwidget-92d72abcaf15ea31dc25" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-92d72abcaf15ea31dc25">{"x":{"filter":"none","caption":"<caption>Table 2: Data aggregation by reporter, flow, and year.<\/caption>","data":[[76,76,76,76,76,76,76,76,76,76,76,76,76],[1,1,1,1,1,1,1,1,1,1,1,1,1],[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012],["292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90","292.9.1.90"],[2061265,1165355,1467727,1835708,1948360,1893528,2119873,2335584,3375543,3807503,4541085,7303096,32890],[1692078,809005,1224772.63025677,1652935.19460362,1735583.36061187,1805531.4324036,1816387.09460859,1966138.34623177,2086388.07259209,2129944.07628759,2172187,3076390.53723858,2820],[1.21818556827759,1.44047935426852,1.19836691622697,1.11057469524098,1.12259661173124,1.04873721166917,1.1670821744397,1.1879042003714,1.61788837098091,1.78760702799124,2.09055896200465,2.37391706663985,11.6631205673759]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>reporter<\/th>\n      <th>flow<\/th>\n      <th>year<\/th>\n      <th>faocode<\/th>\n      <th>value<\/th>\n      <th>weight<\/th>\n      <th>uv<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","pageLength":13,"columnDefs":[{"className":"dt-right","targets":[0,1,2,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,13,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatCurrency(this, row, data, 4, '$', 0, 3, ',', '.', true);\nDTWidget.formatRound(this, row, data, 5, 2, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 6, 2, 3, ',', '.');\nvar value=data[2]; $(row).css({'color':value == 2005.000000 ? '#DDDDDD' : '','background-color':value == 2005.000000 ? '#3B556E' : ''});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p>In Figure 1 is shown the same information stored in Table 1, i.e., the unit value computed in the aggregated level by year. The outlier can be easily identified when we look to the graphic below. The <code>uv</code> seems to be a stable behavior from 2000 to 2011 when you analyze Figure 1. However, in 2012 a sharp increase in the <code>uv</code> is noted. On the other hand, when we look at Figure 2, that is the same information, but without the year 2012, so it is possible to see clearly the increasing trend starting in 2007.</p>
<div class="row">
<div class="col-md-6">
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-2-1.svg" alt="Figure 1: The whole time series of imports." width="672" />
<p class="caption">
Figure 3.1: Figure 1: The whole time series of imports.
</p>
</div>
</div>
<div class="col-md-6">
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-3-1.svg" alt="Figure 2: The time series of imports without the year 2012." width="672" />
<p class="caption">
Figure 3.2: Figure 2: The time series of imports without the year 2012.
</p>
</div>
</div>
</div>
<p>Despite the visual approach works well to identify the possible outliers, it is not possible to check each graphic to figure out the outliers. Therefore, it needs to use a general rule that can be applied in each combination. In the next section, we show two methods to figure out outliers in the trade data, the first one is the Boxplot, and the second one is the Median Absolute Deviation (MAD).</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-workflow.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outlier-detection-in-the-aggregated-level.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
